<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Results Page</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        function showDetails(doctor, age, date, duration, avg_latency, accuracy) {
            document.getElementById('detailsBox').classList.remove('hidden');
            document.getElementById('doctor').innerText = 'Doctor: ' + doctor;
            document.getElementById('age').innerText = 'Age: ' + age;
            document.getElementById('date').innerText = 'Date: ' + date;
            document.getElementById('duration').innerText = 'Duration: ' + duration;
            document.getElementById('latency').innerText = 'Avg Latency: ' + avg_latency + ' ms';
            document.getElementById('accuracy').innerText = 'Accuracy: ' + accuracy + ' %';
        }

        function closeDetails() {
            document.getElementById('detailsBox').classList.add('hidden');
        }

        function filterTests() {
            let searchValue = document.getElementById('searchInput').value.toLowerCase();
            let testItems = document.querySelectorAll('.test-item');

            testItems.forEach(item => {
                let testText = item.innerText.toLowerCase();
                if (testText.includes(searchValue)) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });
        }

        function exportTestData(testId) {
            window.location.href = `/basic/export_test_data/?test_id=${testId}`;
        }
    </script>
    <style>
        :root {
            --light-purple: #f9f0ff;
            --sidebar-purple: #f3e8ff;
            --button-purple: #7c3aed;
        }
    </style>
</head>
<body class="bg-[var(--light-purple)] font-sans">
<div class="flex h-screen">
    <div class="w-64 bg-[var(--sidebar-purple)] p-6">
        <button class="w-full bg-[var(--button-purple)] text-white py-2 rounded-lg">Create New Test</button>
        <nav class="mt-6">
            <a href="#" class="block py-2">Dashboard</a>
            <a href="#" class="block py-2">Results</a>
            <a href="#" class="block py-2">Statistics</a>
        </nav>
    </div>
    <div class="flex-1 p-8">
        <h1 class="text-2xl font-semibold">Test Results Page</h1>
        <div class="mt-4 w-1/3 bg-white p-2 rounded shadow flex items-center">
            <input id="searchInput" type="text" placeholder="Search test ID or Doctor..."
                   class="border-none outline-none flex-grow">
            <button onclick="filterTests()" class="ml-2">üîç</button>
        </div>
        <div class="mt-6 w-1/2 space-y-3">
            {% for test in test_sessions %}
                <div class="test-item bg-white p-4 rounded shadow flex justify-between items-center">
                    <span>Test #{{ test.test_id }} - Dr. {{ test.doctor.username }}</span>
                    <div class="flex gap-2">
                        <!-- Download Button -->
                        <button onclick="exportTestData('{{ test.test_id }}')"
                                class="bg-[var(--button-purple)] text-white px-4 py-2 rounded">
                            Download
                        </button>
                        <!--View Button -->
                        <button onclick="showDetails('{{ test.doctor.username }}', '{{ test.age }}', '{{ test.date }}', '{{ test.duration }}', '{{ test.avg_latency }}', '{{ test.accuracy }}')"
                                class="bg-[var(--button-purple)] text-white px-4 py-2 rounded">
                            View
                        </button>
                    </div>
                </div>
            {% empty %}
                <p>No test sessions available.</p>
            {% endfor %}
        </div>
    </div>
</div>
<div id="detailsBox" class="hidden fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50">
    <div class="bg-white p-6 rounded-lg shadow-lg w-1/3 text-center">
        <h2 class="text-xl font-semibold mb-4">Test Details</h2>
        <p id="doctor"></p>
        <p id="age"></p>
        <p id="date"></p>
        <p id="duration"></p>
        <p id="latency"></p>
        <p id="accuracy"></p>
        <button onclick="closeDetails()" class="mt-4 bg-red-500 text-white px-4 py-2 rounded">Close</button>
    </div>
</div>
</body>
</html>





