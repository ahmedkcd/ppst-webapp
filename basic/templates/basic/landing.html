{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>PPST - Doctor Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <link rel="stylesheet" href="{% static 'basic/styleslanding.css' %}"/>
</head>

<body>
<!-- Header -->
<header class="header">
    <a href="#"><div class="header-text">PPST</div></a>
    <div class="header-dashboard">
        {% if user.is_authenticated %}
            <a href="{% url 'basic:doctor-dashboard' %}">
        {% else %}
            <a href="{% url 'basic:doctor-login' %}">
        {% endif %}
            <button class="btn btn-header">Open Dashboard</button>
        </a>
    </div>
</header>

<!-- Landing Content -->
<div class="landing">
    <h1>Welcome to PPST</h1>
    <div class="button-container">
        <button class="btn btn-secondary">Contact Admin</button>

        {% if user.is_authenticated %}
            <a href="{% url 'basic:doctor-dashboard' %}">
                <button class="btn btn-primary">Go to Dashboard</button>
            </a>
        {% else %}
            <a href="{% url 'basic:doctor-login' %}">
                <button class="btn btn-primary">Login</button>
            </a>
        {% endif %}
    </div>
</div>

<!-- About Section -->
<div class="info-section">
    <div class="info-container">
        <h2 class="info-heading">What is PPST?</h2>
        <p class="info-text">
            The Philadelphia Spanning Test (PPST) is a cognitive assessment designed to measure working
            memory and executive function. In this test, participants are shown a sequence of numbers
            and must rearrange them in ascending order. The difficulty increases as the number of
            digits grows, challenging memory capacity and processing speed. PPST is widely used in
            psychological research and cognitive studies to analyze attention, learning ability,
            and neurological conditions.
        </p>
    </div>
</div>

<!-- Stats Section -->
<div class="stats-section">
    <div class="stat">
        <span class="stat-title">Total Tests Taken</span>
        <span class="stat-number" data-target="{{ total_tests }}">0</span>
    </div>
    <div class="stat">
        <span class="stat-title">Registered Doctors</span>
        <span class="stat-number" data-target="{{ total_doctors }}">0</span>
    </div>
</div>

<!-- Features Section -->
<div class="features-section">
    <h3 class="features-title">FEATURES</h3>
    <h2 class="features-heading">
        Flexible for Doctors. <br/>
        Easy for Patients.
    </h2>
    <div class="features-container">
        <div class="feature">
            <span class="feature-icon">üåê</span>
            <h4 class="feature-title">Multilingual</h4>
            <p class="feature-description">
                The PPST web app supports English and Spanish, making it accessible to a wider audience.
                More languages will be added in future updates to enhance inclusivity and usability.
            </p>
        </div>
        <div class="feature">
            <span class="feature-icon">üìä</span>
            <h4 class="feature-title">Doctor Analytics</h4>
            <p class="feature-description">
                Doctors can access detailed statistics on patient performance and sitewide trends,
                helping them track progress and make informed assessments.
            </p>
        </div>
    </div>
</div>

<!-- Animation Script -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        gsap.to("h1", {
            opacity: 1,
            scale: 1,
            duration: 1,
            ease: "elastic.out(1, 0.5)",
        });

        gsap.to(".button-container", {
            opacity: 1,
            y: 0,
            duration: 1,
            delay: 0.5,
            ease: "power2.out",
        });

        function animateNumber(element, targetNumber, duration = 1500) {
            let startTime = null;
            const startNumber = Math.floor(targetNumber * 0.1);
            const randomOffset = Math.floor(targetNumber * 0.2);

            function updateNumber(currentTime) {
                if (!startTime) startTime = currentTime;
                const elapsedTime = currentTime - startTime;
                const progress = Math.min(elapsedTime / duration, 1);

                const randomFlicker = Math.floor(Math.random() * randomOffset);
                const currentNumber = Math.floor(
                    startNumber +
                    (targetNumber - startNumber) * progress +
                    randomFlicker * (1 - progress)
                );

                element.textContent = currentNumber.toLocaleString();

                if (progress < 1) {
                    requestAnimationFrame(updateNumber);
                } else {
                    element.textContent = targetNumber.toLocaleString();
                }
            }

            requestAnimationFrame(updateNumber);
        }

        function startAnimations() {
            document.querySelectorAll(".stat-number").forEach((stat) => {
                const targetNumber = parseInt(stat.getAttribute("data-target"));
                animateNumber(stat, targetNumber);
            });
        }

        function handleScroll() {
            const statsSection = document.querySelector(".stats-section");
            if (statsSection) {
                const rect = statsSection.getBoundingClientRect();
                if (rect.top < window.innerHeight * 0.75) {
                    startAnimations();
                    window.removeEventListener("scroll", handleScroll);
                }
            }
        }

        window.addEventListener("scroll", handleScroll);
        handleScroll();
    });
</script>
</body>
</html>
